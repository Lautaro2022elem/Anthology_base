[logic]
active = {+esc_megafone_broken} nil, ph_idle@wait

[ph_idle@wait]
on_info = %=play_sound(escape_sr_rupor_megafon_sound)%
on_signal = sound_end | ph_idle@comandir
on_info2 = {=is_night} ph_idle@night
on_info3 = {=check_smart_alarm_status(esc_smart_terrain_3_16)} ph_idle@alarm
hit_on_bone = 2 |ph_idle@broken

[ph_idle@comandir]
on_info = %=play_sound(escape_sr_rupor_comandir_sound)%
on_signal = sound_end | ph_idle@wait
on_info2 = {=is_night} ph_idle@night
on_info3 = {=check_smart_alarm_status(esc_smart_terrain_3_16)} ph_idle@alarm
hit_on_bone = 2 |ph_idle@broken

[ph_idle@night]
on_info = %=play_sound(no_sound_mlr)%
on_info2 = {!is_night} ph_idle@wait
on_info3 = {=check_smart_alarm_status(esc_smart_terrain_3_16)} ph_idle@alarm
hit_on_bone = 2 |ph_idle@broken

[ph_idle@alarm]
on_info = %=play_sound(escape_sr_rupor_alarm)%
on_info2 = {!check_smart_alarm_status(esc_smart_terrain_3_16)} ph_idle@wait
hit_on_bone = 2 |ph_idle@broken

[ph_idle@broken]
on_info = nil %=stop_sound +esc_megafone_broken%
